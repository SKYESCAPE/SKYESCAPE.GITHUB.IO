---
layout: post
title: FPGA学习(五)——VHDL描述语句
date:2019-1-28
categories: blog
tags: [FPGA,VHDL]
description: 文章金句。
---

# 前言
VHDL的描述语句分为并行语句与顺序语句。顺序语句与并行语句共同构成了VHDL的描述语句，是VHDL作为硬件描述语句的一大特点。并行语句是硬件描述语言的一大特点，它与像C语言的高级程序设计语言最大的不同是并行语句的执行是并行的，不会因为书写顺序的前后而产生执行时的先后。顺序语句只在仿真时间上是相对并行语句而言的，实际硬件的运行不一定是顺序执行的。

#并行语句
VHDL支持的并行语句主要有七种：端口映射语句、信号赋值语句、when条件选择语句、generate语句、进程语句、过程调用语句和块语句。并行语句可以在结构体的begin与end之间的任何位置。**并行语句之所以能够并行，在于VHDL程序的每一条语句甚至每一个操作符都可能对应一个硬件电路，而电路一直是并行的，相当于同时具有多个CPU**(区别于C语言对应单独CPU顺序执行)。**因此VHDL程序的每一行代码都要占用一定的FPGA资源，**因此代码优化就格外重要。

### 映射语句和元件例化语句
**映射语句**主要应用于模块调用，在例化模块时用于传递类属性参数和端口连接。使用方法如下例

```
--例：一个加了一个固定数的加法模块
library ieee; 
use ieee.std_logic_1164.all; 
use ieee. std_logic_unsigned.all; 

entity myadder is 
--声明一个类属性参数、一个固定数值的加数 
generic( 
     addend ： std_logic_vector(7 downto 0) ： = ”00001010" 
     );
port (data : in s td_ logic_vector( 7 downto 0); 
     sumo : out std_logic_vector(7 downto 0)); 
end myadder ;

architecture dataflow of myadder is 
begin  
     sumo <= data + addend ; --做加法运箅
end dataflow;
```

**component语句**的意义是声明被引用模块的接口信息，以便调用该模块时正确进行端口 与类属性参数的连接。component的格式如下：

```
component <component_name>
     generic(
     <name> : <type> ;
     <name> : <type> := <default_value>
     ) ;
     port(
     --input ports
     <name> : in <type> ;
     --inout ports
     <name> : inout <type> ;
     --output ports
     <name> : in <type> 
     ) ;
end component ;
```

**模块的例化**就是在VHDL程序中用在结构体声明中声明的模块，模块例化一次就产生了一块硬件电路，例化两次就产生两块硬件电路。模块例化的格式如下：

```
<instance_name> : <component_name>
	generic map(
		<name> => <value>,
		...
	) 
	port map(
		<formal_input> => <expression>,
		<formal_output> => <signal>,
		<formal_inout> => <signal>,
	);
```

例：调用上述加法模块

```
library ieee ; 
use ieee.std_logic_1164.all ;
--由于调用了上述代码的模块，所以需要引用上述代码所在的库
--如果它们在同一目录下，则该代码的模块默认属于work库 
--由于work是默认被引用的，可以省略
library work ;
entity testmap is 
	port(
		dataone : in std_logic_vector(7 downto 0) ;
		datatwo : in std_logic_vector(7 downto 0) ; 
		datathree : in std_logic_vector(7 downto 0) ; 
		sumone : out std_logic_vector(7 downto 0) ; 
		sumtwo : out std_logic_vector(7 downto 0) ; 
		sumthree : out std_logic_vector(7 downto 0) ;
	)
end testmap ;
architectur construct of testmap is
--在结构声明部分，需要声明被引用的模块 
--声明被引用的模块格式与该模块的实体声明类似 
--类属性的参数不需要初始值，因为在调用时需要重新赋于新值
component myadder 
	generic (addend : std_logic_vector(7 downto 0) 
	) ;
	port(data : in std_logic_vector( 7 downto 0) ; 
		 sumo : out std_logic_vector(7 downto 0) 
	) ;
end component ;
begin
--例化模块myadder
adderone : myadder
--类属性参数设置为10
generic map( addend => "00001010"
)
--端口连接方式一
port map(data => dataone,
		sumo =>sumone
		);

--例化模块myadder
addertwo : myadder
--类属性参数设置为20
generic map( addend => "00010100"
)
--端口连接方式一
port map(data => datatwo,
		sumo =>sumtwo
		);

--例化模块myadder
adderthree : myadder
--类属性参数设置为20
generic map( addend => "00010100"
)
--端口连接方式二
--端口连接方式二由于没有原端口的一一对应 
--所以在顺序上一定要与原端口的顺序保持完全一致，才是正确端口连接
port map(datathree,
		sumthree
		);
end construct ;
```

### 并行赋值语句
并行陚值语句是最简单的并行语句，基本格式为：信号<=表达式；并行賦值语句由4部分组成：左操作数、陚值操作符、"<="、表示式和";"。其中，左操作数不能是输人端口信号，表达式中不能含有输出端口信号。

### 进程语句
进程语句process是VHDL程序最常用与最重要的并行语句之一。进程本身是并行语句，多个process语句是并行执行的，但它却是由顺序语句组成的。它可以组合成组合电路，也可组合成时序电路。进程语句基本格式为：

```

```